% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dstudy_p_nested4.R
\name{dstudy_p_nested4}
\alias{dstudy_p_nested4}
\title{Execute a Partially Nested Bayesian D-Study -- (i x o):p}
\usage{
dstudy_p_nested4(
  data,
  col.scores,
  col.subjects,
  col.facet1,
  col.facet2,
  seq1,
  seq2,
  threshold = 0.7,
  rounded = 3,
  quantiles = c(0.025, 0.975),
  prior = NULL,
  warmup = 2000,
  iter = 5000,
  chains = 4,
  cores = 4,
  adapt_delta = 0.995,
  max_treedepth = 15
)
}
\arguments{
\item{data}{A data frame containing data from a partially nested, two-facet design with the two facets crossed and then nested within subjects. Must have one or more columns for metrics of interest, one column for labeling subjects, and two columns for labeling facets.}

\item{col.scores}{The name of the column containing the metric of interest (i.e. scores, readings, etc.). Must follow C++ naming conventions (only letters, numbers, and underscores; no spaces or hyphens!). Enter as a string.}

\item{col.subjects}{The name of the column containing the labels for the subjects. Must follow C++ naming conventions (only letters, numbers, and underscores; no spaces or hyphens!).Enter as a string.}

\item{col.facet1}{The name of the column containing the labels for the first facet. Must follow C++ naming conventions (only letters, numbers, and underscores; no spaces or hyphens!). Enter as a string.}

\item{col.facet2}{The name of the column containing the labels for the second facet. Must follow C++ naming conventions (only letters, numbers, and underscores; no spaces or hyphens!). Enter as a string.}

\item{seq1}{A sequence of integers defining the interval at which to test the first facet. Enter a vector, or use the seq() function directly.}

\item{seq2}{A sequence of integers defining the interval at which to test the second facet. Enter a vector, or use the seq() function directly.}

\item{threshold}{A decimal between 0 and 1. Will be used to calculate the probability of the reliability coefficient being above the inputted threshold. 0.7 by default.}

\item{rounded}{The number of decimal places the variance components, reliability coefficients, and probabilities should be rounded to. 3 by default.}

\item{quantiles}{A list containing two quantiles (between 0 and 1) at which to evaluate the variance components and reliability coefficients. Set to c(0.025, 0.975) by default.}

\item{prior}{An optional set of prior distributions for the variance components, specified by the user through the set_prior() function in brms. To ensure correctly formatted priors, the user should first use the get_prior() function with the formula "col.scores ~ (1|col.subjects/col.facet1) + (1|col.subjects:col.facet2)". Type ?brms::set_prior in the console for more information. NULL by default.}

\item{warmup}{Number of iterations to use per chain as the burn-in period for MCMC sampling. 2000 by default.}

\item{iter}{Number of total iterations per chain (including warmup). 5000 by default.}

\item{chains}{Number of Markov chains. 4 by default.}

\item{cores}{Number of cores to use when executing chains in parallel. 4 by default. Note: The number of threads is set to 2 by default and cannot be changed. The number of cores times the number of threads should not exceed the number of logical CPU cores in your operating system. Adjust this parameter accordingly! To check how many logical CPU cores you have, run parallel::detectCores() in the console.}

\item{adapt_delta}{A value between 0 and 1. A larger value slows down the sampler but decreases the number of divergent transitions. 0.995 by default.}

\item{max_treedepth}{Sets the maximum tree depth in the No U-Turn Sampler (NUTS). Set to 15 by default, but can be increased if tree depth is exceeded.}
}
\value{
Two dataframes. The gstudy dataframe contains the lower bound, median, and upper bound of the distributions for each of the variance components in the G-study (according to the quantiles set by the user in the quantiles argument). The dstudy dataframe contains the sequence of values to be tested for facet 1 and facet 2, the lower and upper quantiles of the reliability coefficient specified by the user, the median of the reliability coefficient, and the probability of the coefficient being above the inputted threshold.
}
\description{
Execute a Partially Nested Bayesian D-Study -- (i x o):p
}
\details{
This function uses the "cmdstanr" backend for communication with STAN, so installation of the 'cmdstanr' package is required. To install 'cmdstanr', first run install.packages("cmdstanr", repos = c("https://mc-stan.org/r-packages/", getOption("repos"))), and then run cmdstanr::install_cmdstan(). To verify installation, run cmdstanr::cmdstan_version().
}
\note{
The median is used as the measure of center for both the variance components and the reliability coefficients because these distributions are rarely normal (or even symmetric). The most appropriate measure of center for skewed distributions like these is the one which is most resistant to outliers, which is the median.

Thank you to Sven de Maeyer from the University of Antwerp for inspiring this Bayesian G-Theory package! See his blog post at https://svendemaeyer.netlify.app/posts/2021-04-generalizability/.
}
\examples{
suppressMessages(suppressWarnings({
Person <- c(rep(1, 6), rep(2,6), rep(3,6), rep(4,6), rep(5,6))
Item <- c(rep(c(1,2,3),2), rep(c(4,5,6),2), rep(c(7,8,9),2),
           rep(c(10,11,12),2), rep(c(13,14,15),2))
Occasion <- c(rep(1,3), rep(2,3), rep(3,3), rep(4,3), rep(5,3),
             rep(6,3), rep(7,3), rep(8,3), rep(9,3), rep(10,3))
Score <- c(19,17,20,18,18,20,15,15,17,16,17,17,20,20,19,20,20,
          20,11,14,12,12,13,12,18,19,18,19,18,19)
sample_data <- data.frame(Person, Item, Occasion, Score)
dstudy_p_nested4(data = sample_data, col.scores = "Score", col.subjects = "Person",
                col.facet1 = "Item", col.facet2 = "Occasion", seq1 = seq(1,5,1),
                seq2 = seq(1,3,1), threshold = 0.5, warmup = 1000, iter = 4000, chains = 1)
}))
}
